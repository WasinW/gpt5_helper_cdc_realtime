ThisBuild / scalaVersion := "2.12.18"

lazy val versions = new {
  val beam = "2.58.0"
  val gcloudBq = "2.43.2"
  val slf4j = "2.0.12"
  val gson = "2.10.1"
  val snake = "2.0"
  val awsSdk = "2.25.62"
}

lazy val root = (project in file("."))
  .aggregate(framework, memberPipeline)
  .settings(
    name := "gpt5-helper-cdc-realtime",
    version := "0.3.0"
  )

lazy val commonLibs = Seq(
  "org.apache.beam" % "org.apache.beam" % "beam-sdks-java-core" % versions.beam,
  "org.apache.beam" % "beam-runners-direct-java" % versions.beam % versions.beam,
  "org.apache.beam" % "beam-runners-google-cloud-dataflow-java" % versions.beam,
  "com.google.cloud" % "google-cloud-bigquery" % versions.gcloudBq,
  "software.amazon.awssdk" % "s3" % versions.awsSdk,
  "com.google.code.gson" % "gson" % versions.gson,
  "org.yaml" % "snakeyaml" % versions.snake,
  "org.slf4j" % "slf4j-api" % versions.slf4j
)

lazy val framework = (project in file("framework")).settings(
  name := "cdc-framework",
  libraryDependencies ++= commonLibs
)

lazy val memberPipeline = (project in file("member-pipeline")).dependsOn(framework).settings(
  name := "member-pipeline"
)
/* common-runner-deps */
ThisBuild / scalaVersion := "2.12.18"
val beamV = "2.58.0"
libraryDependencies ++= Seq(
  "org.apache.beam" % "beam-sdks-java-core" % beamV,
  "org.apache.beam" % "beam-sdks-java-io-google-cloud-platform" % beamV,
  "org.yaml" % "snakeyaml" % "2.2",
  "com.fasterxml.jackson.core" % "jackson-databind" % "2.17.1",
  "com.fasterxml.jackson.module" %% "jackson-module-scala" % "2.17.1"
)

/* aws sdk v2 s3 + secret manager */
libraryDependencies ++= Seq(
  "software.amazon.awssdk" % "s3" % "2.25.43",
  "software.amazon.awssdk" % "auth" % "2.25.43",
  "com.google.cloud" % "google-cloud-secretmanager" % "2.36.0"
)

libraryDependencies += "org.yaml" % "snakeyaml" % "2.3"

libraryDependencies += "com.fasterxml.jackson.core" % "jackson-databind" % "2.17.1"

libraryDependencies += "com.fasterxml.jackson.module" %% "jackson-module-scala" % "2.17.1"

libraryDependencies += "com.google.cloud" % "google-cloud-secretmanager" % "2.36.0"

libraryDependencies += "com.google.cloud" % "google-cloud-storage" % "2.37.0"

libraryDependencies += "software.amazon.awssdk" % "s3" % "2.25.43"

libraryDependencies += "software.amazon.awssdk" % "auth" % "2.25.43"
